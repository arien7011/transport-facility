import{a as Z,b as ee,c as te,e as ie,f as ne,i as oe,j as re,k as ae,l as le,m as de,n as se,r as pe,s as ce,t as E}from"./chunk-6WVEUVZT.js";import{$,Aa as Q,B as j,C as M,Fa as X,J as o,O as k,S as f,W as s,Y as O,_ as P,a as N,aa as G,b as z,ba as U,ca as i,da as t,e as V,ea as x,ha as I,j as w,ja as _,k as L,ka as p,l as h,la as r,ma as c,na as m,oa as K,qa as H,ra as Y,s as u,v as C,w as y,xa as W,ya as q,za as J}from"./chunk-J2AUHKOQ.js";function ue(n,l){if(n&1){let e=I();i(0,"div",12)(1,"button",14),_("click",function(){C(e);let g=p(2);return y(g.onBookRide(g.ride().id))}),r(2),t()()}if(n&2){let e=p(2);o(),s("disabled",!e.canBook()),o(),m(" ",e.canBook()?"Book Ride":"Cannot Book"," ")}}function xe(n,l){if(n&1&&(i(0,"span",16),r(1),t()),n&2){let e=l.$implicit;o(),c(e)}}function _e(n,l){if(n&1&&(i(0,"div",13)(1,"h4"),r(2,"Booked by:"),t(),i(3,"div",15),G(4,xe,2,1,"span",16,$),t()()),n&2){let e,a=p(2);o(4),U((e=a.ride())==null?null:e.bookedEmployees)}}function be(n,l){if(n&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),r(4),t(),i(5,"span",5),r(6),t()(),i(7,"div",6)(8,"span",7),r(9),t()()(),i(10,"div",8)(11,"div",9)(12,"span",10),r(13,"Time:"),t(),i(14,"span",11),r(15),t()(),i(16,"div",9)(17,"span",10),r(18,"From:"),t(),i(19,"span",11),r(20),t()(),i(21,"div",9)(22,"span",10),r(23,"To:"),t(),i(24,"span",11),r(25),t()(),i(26,"div",9)(27,"span",10),r(28,"Driver:"),t(),i(29,"span",11),r(30),t()()(),f(31,ue,3,2,"div",12)(32,_e,6,0,"div",13),t()),n&2){let e,a,g,b,S,v,T,B,F,D,A,d=p();O("fully-booked",((e=d.ride())==null?null:e.vacantSeats)===0),o(3),O("bike",((a=d.ride())==null?null:a.vehicleType)===d.vehicleTypes.BIKE),o(),m(" ",(g=d.ride())==null?null:g.vehicleType," "),o(2),c((b=d.ride())==null?null:b.vehicleNo),o(2),O("no-seats",((S=d.ride())==null?null:S.vacantSeats)===0),o(),K(" ",(v=d.ride())==null?null:v.vacantSeats,"/",(v=d.ride())==null?null:v.originalSeats," seats "),o(6),c((T=d.ride())==null?null:T.time),o(5),c((B=d.ride())==null?null:B.pickupPoint),o(5),c((F=d.ride())==null?null:F.destination),o(5),c((D=d.ride())==null?null:D.employeeId),o(),P(d.showBookButton()&&d.ride()&&d.ride().vacantSeats>0?31:-1),o(),P((A=d.ride())!=null&&A.bookedEmployees&&d.ride()&&d.ride().bookedEmployees.length>0?32:-1)}}var R=class n{ride=M();vehicleTypes=E;canBook=M(!0);showBookButton=M(!1);router=u(X);bookRide=j();ngOnInit(){console.log({canbook:this.canBook()})}onBookRide(l){this.canBook()&&this.bookRide.emit(l)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=k({type:n,selectors:[["app-ride-card"]],inputs:{ride:[1,"ride"],canBook:[1,"canBook"],showBookButton:[1,"showBookButton"]},outputs:{bookRide:"bookRide"},decls:1,vars:1,consts:[[1,"ride-card",3,"fully-booked"],[1,"ride-card"],[1,"ride-header"],[1,"vehicle-info"],[1,"vehicle-type"],[1,"vehicle-number"],[1,"seats-info"],[1,"seats-count"],[1,"ride-details"],[1,"detail-row"],[1,"label"],[1,"value"],[1,"ride-actions"],[1,"booked-employees"],[1,"book-btn",3,"click","disabled"],[1,"employee-list"],[1,"employee-tag"]],template:function(e,a){e&1&&f(0,be,33,16,"div",0),e&2&&P(a.ride()?0:-1)},styles:[".ride-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease}.ride-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #00000026;transform:translateY(-2px)}.ride-card.fully-booked[_ngcontent-%COMP%]{opacity:.7;border-color:#ccc}.ride-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;border-bottom:1px solid #f0f0f0;padding-bottom:8px}.vehicle-info[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.vehicle-type[_ngcontent-%COMP%]{background:#4caf50;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:700;text-transform:uppercase}.vehicle-type.bike[_ngcontent-%COMP%]{background:#2196f3}.vehicle-number[_ngcontent-%COMP%]{font-weight:700;color:#333;font-size:14px}.seats-info[_ngcontent-%COMP%]{text-align:right}.seats-count[_ngcontent-%COMP%]{background:#e8f5e8;color:#2e7d32;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:700}.seats-count.no-seats[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.ride-details[_ngcontent-%COMP%]{margin:12px 0}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px;padding:4px 0}.label[_ngcontent-%COMP%]{color:#666;font-weight:500;min-width:60px}.value[_ngcontent-%COMP%]{color:#333;font-weight:400;text-align:right;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ride-actions[_ngcontent-%COMP%]{margin-top:12px;text-align:center}.book-btn[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:700;transition:background-color .3s ease;width:100%}.book-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#45a049}.book-btn[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.booked-employees[_ngcontent-%COMP%]{margin-top:12px;border-top:1px solid #f0f0f0;padding-top:8px}.booked-employees[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:12px;color:#666;text-transform:uppercase}.employee-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:4px}.employee-tag[_ngcontent-%COMP%]{background:#f5f5f5;color:#333;padding:2px 6px;border-radius:3px;font-size:11px;font-weight:500}@media (max-width: 768px){.ride-card[_ngcontent-%COMP%]{padding:12px}.vehicle-info[_ngcontent-%COMP%]{flex-direction:column;gap:4px;align-items:flex-start}.ride-header[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}.seats-info[_ngcontent-%COMP%]{text-align:left;width:100%}}"]})};function ve(n,l){if(n&1&&(i(0,"div",27),r(1),H(2,"date"),t()),n&2){let e=p();o(),m(" Last updated: ",Y(2,1,e.lastUpdated,"HH:mm:ss")," ")}}function he(n,l){n&1&&(i(0,"div",28),x(1,"div",29),i(2,"p"),r(3,"Loading available rides..."),t()())}function Ce(n,l){n&1&&(i(0,"div",30)(1,"p"),r(2," Please enter your Employee ID above to view and book available rides. "),t()())}function ye(n,l){n&1&&(i(0,"div",31),x(1,"img",32),i(2,"h4"),r(3,"No rides available"),t(),i(4,"p"),r(5,"There are no rides matching your criteria at the moment."),t(),i(6,"p"),r(7,"Try adjusting your filters or check back later."),t()())}function Me(n,l){if(n&1){let e=I();i(0,"app-ride-card",35),_("bookRide",function(g){C(e);let b=p(2);return y(b.onBookRide(g))}),t()}if(n&2){let e=l.$implicit,a=p(2);s("ride",e)("showBookButton",!0)("canBook",a.canBookRide(e))}}function ke(n,l){if(n&1&&(i(0,"div",33),f(1,Me,1,3,"app-ride-card",34),t()),n&2){let e=p();o(),s("ngForOf",e.filteredRides)("ngForTrackBy",e.trackByRideId)}}function Oe(n,l){if(n&1&&(i(0,"div",36),r(1),t()),n&2){let e=p();o(),m(" ",e.successMessage," ")}}function Pe(n,l){if(n&1&&(i(0,"div",37),r(1),t()),n&2){let e=p();o(),m(" ",e.errorMessage," ")}}var me=class n{destroy$=new V;filtersForm;filteredRides=[];currentEmployeeId="";currentDate="";lastUpdated=null;isLoading=!1;successMessage="";errorMessage="";vehicleTypes=E;rideService=u(ee);fb=u(pe);employeeIdControl=this.fb.control("");ngOnInit(){this.currentDate=Z.getCurrentDate(),this.initializeForms(),this.setupSubscriptions(),this.loadRides()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForms(){this.filtersForm=this.fb.group({vehicleType:[""],searchTime:[""]})}setupSubscriptions(){this.employeeIdControl.valueChanges.pipe(w(300),h(this.destroy$)).subscribe(l=>{this.currentEmployeeId=l?.trim()||"",this.clearMessages(),this.currentEmployeeId?this.loadRides():this.filteredRides=[]}),this.filtersForm.valueChanges.pipe(L(this.filtersForm.value),w(300),h(this.destroy$)).subscribe(()=>{this.currentEmployeeId&&this.loadRides()})}loadRides(){if(!this.currentEmployeeId)return;this.isLoading=!0;let l=z(N({},this.filtersForm.value),{employeeId:this.currentEmployeeId});Object.keys(l).forEach(e=>{l[e]||delete l[e]}),this.rideService.availableRides(l).pipe(h(this.destroy$)).subscribe({next:e=>{this.filteredRides=e,this.lastUpdated=new Date,this.isLoading=!1},error:e=>{console.error("Error loading rides:",e),this.errorMessage="Failed to load available rides. Please try again.",this.isLoading=!1}})}onBookRide(l){if(!this.currentEmployeeId){this.errorMessage="Please enter your Employee ID first.";return}this.clearMessages(),this.rideService.bookRide(l,this.currentEmployeeId).subscribe({next:e=>{e?(this.successMessage="Ride booked successfully!",this.loadRides(),setTimeout(()=>this.successMessage="",3e3)):this.errorMessage="Failed to book ride. It may be full or you may have already booked it."},error:e=>{console.error("Error booking ride:",e),this.errorMessage="An error occurred while booking the ride. Please try again."}})}canBookRide(l){return this.currentEmployeeId?this.rideService.canBookRide(l.id,this.currentEmployeeId):!1}clearFilters(){this.filtersForm.reset({vehicleType:"",searchTime:""})}clearMessages(){this.successMessage="",this.errorMessage=""}trackByRideId(l,e){return e.id}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=k({type:n,selectors:[["app-available-rides"]],decls:44,vars:15,consts:[[1,"available-rides-container"],[1,"subtitle"],[1,"employee-section"],[1,"form-group"],["for","currentEmployeeId"],["type","text","id","currentEmployeeId","placeholder","Enter your employee ID to book rides",1,"employee-input",3,"formControl"],[1,"help-text"],[1,"filters-section",3,"formGroup"],[1,"filters-row"],[1,"filter-group"],["for","vehicleType"],["id","vehicleType","formControlName","vehicleType"],["value",""],[3,"value"],["for","searchTime"],["type","time","id","searchTime","formControlName","searchTime","title","Find rides within 60 minutes of this time"],[1,"filter-actions"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"results-section"],[1,"results-header"],["class","refresh-info",4,"ngIf"],["class","loading",4,"ngIf"],["class","warning-message",4,"ngIf"],["class","no-rides",4,"ngIf"],["class","rides-list",4,"ngIf"],["class","message success",4,"ngIf"],["class","message error",4,"ngIf"],[1,"refresh-info"],[1,"loading"],[1,"loading-spinner"],[1,"warning-message"],[1,"no-rides"],["src","assets/icons/car.png","width","50","height","50","alt","No Rides Available"],[1,"rides-list"],[3,"ride","showBookButton","canBook","bookRide",4,"ngFor","ngForOf","ngForTrackBy"],[3,"bookRide","ride","showBookButton","canBook"],[1,"message","success"],[1,"message","error"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"h2"),r(2,"Available Rides"),t(),i(3,"p",1),r(4),t(),i(5,"div",2)(6,"div",3)(7,"label",4),r(8,"Your Employee ID *"),t(),x(9,"input",5),i(10,"div",6),r(11," Enter your employee ID to see available rides and book them "),t()()(),i(12,"div",7)(13,"h3"),r(14,"Filter Rides"),t(),i(15,"div",8)(16,"div",9)(17,"label",10),r(18,"Vehicle Type"),t(),i(19,"select",11)(20,"option",12),r(21,"All Vehicles"),t(),i(22,"option",13),r(23),t(),i(24,"option",13),r(25),t()()(),i(26,"div",9)(27,"label",14),r(28,"Time (\xB160 min)"),t(),x(29,"input",15),t(),i(30,"div",16)(31,"button",17),_("click",function(){return a.clearFilters()}),r(32," Clear Filters "),t()()()(),i(33,"div",18)(34,"div",19)(35,"h3"),r(36),t(),f(37,ve,3,4,"div",20),t(),f(38,he,4,0,"div",21)(39,Ce,3,0,"div",22)(40,ye,8,0,"div",23)(41,ke,2,2,"div",24),t(),f(42,Oe,2,1,"div",25)(43,Pe,2,1,"div",26),t()),e&2&&(o(4),m("Find and book rides for today (",a.currentDate,")"),o(5),s("formControl",a.employeeIdControl),o(3),s("formGroup",a.filtersForm),o(10),s("value",a.vehicleTypes.BIKE),o(),c(a.vehicleTypes.BIKE),o(),s("value",a.vehicleTypes.CAR),o(),c(a.vehicleTypes.CAR),o(11),m("Available Rides (",a.filteredRides.length,")"),o(),s("ngIf",a.lastUpdated),o(),s("ngIf",a.isLoading),o(),s("ngIf",!a.currentEmployeeId&&!a.isLoading),o(),s("ngIf",a.currentEmployeeId&&a.filteredRides.length===0&&!a.isLoading),o(),s("ngIf",a.currentEmployeeId&&a.filteredRides.length>0&&!a.isLoading),o(),s("ngIf",a.successMessage),o(),s("ngIf",a.errorMessage))},dependencies:[Q,W,q,J,ce,de,se,te,le,ie,ne,oe,re,ae,R],styles:[".available-rides-container[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:20px}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:8px;text-align:center}.subtitle[_ngcontent-%COMP%]{color:#666;text-align:center;margin-bottom:30px;font-style:italic}.employee-section[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;margin-bottom:30px;border-left:4px solid #4CAF50}.employee-input[_ngcontent-%COMP%]{padding:12px;border:2px solid #e0e0e0;border-radius:6px;font-size:14px;width:100%;max-width:300px}.employee-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50}.help-text[_ngcontent-%COMP%]{color:#666;font-size:12px;margin-top:4px}.filters-section[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:20px;margin-bottom:30px}.filters-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;color:#333;font-size:18px}.filters-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr auto;gap:20px;align-items:end}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;margin-bottom:6px;font-size:14px}.filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px;border:2px solid #e0e0e0;border-radius:6px;font-size:14px}.filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50}.filter-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.results-section[_ngcontent-%COMP%]{background:#fff}.results-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:10px;border-bottom:2px solid #f0f0f0}.results-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.refresh-info[_ngcontent-%COMP%]{color:#666;font-size:12px}.loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:40px 20px;color:#666}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #4CAF50;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.warning-message[_ngcontent-%COMP%]{background:#fff3cd;border:1px solid #ffeaa7;color:#856404;padding:20px;border-radius:8px;text-align:center}.no-rides[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.no-rides-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px}.no-rides[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#333}.no-rides[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;line-height:1.5}.rides-list[_ngcontent-%COMP%]{display:grid;gap:16px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:6px;font-size:14px;font-weight:600;cursor:pointer;transition:all .3s ease}.btn-secondary[_ngcontent-%COMP%]{background:#f5f5f5;color:#333;border:1px solid #ddd}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e8e8e8}.message[_ngcontent-%COMP%]{padding:12px;border-radius:6px;margin-top:16px;font-weight:500;text-align:center}.message.success[_ngcontent-%COMP%]{background:#e8f5e8;color:#2e7d32;border:1px solid #c8e6c8}.message.error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;border:1px solid #ffcdd2}@media (max-width: 768px){.available-rides-container[_ngcontent-%COMP%]{padding:16px}.filters-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.results-header[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}.employee-input[_ngcontent-%COMP%]{max-width:100%}}"]})};export{me as AvailableRidesComponent};
